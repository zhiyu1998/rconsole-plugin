name: ğŸš€ éƒ¨ç½²æ–‡æ¡£

on:
  push:
    branches:
      # ç¡®ä¿è¿™æ˜¯ä½ æ­£åœ¨ä½¿ç”¨çš„åˆ†æ”¯åç§°
      - docs

jobs:
  deploy-gh-pages:
    name: CI&CD # æ­¤ä»»åŠ¡ï¼ˆjobï¼‰çš„åå­—
    runs-on: ubuntu-latest # è¿è¡Œç¯å¢ƒ
    steps:
      - uses: actions/checkout@master # åˆ‡æ¢åˆ†æ”¯åˆ°main
        with:
          fetch-depth: 2

      - name: Use Node.js 18.x
        uses: actions/setup-node@v2.1.4 # ä½¿ç”¨nodeç¯å¢ƒ
        with:
          node-version: '18.x' # ç‰ˆæœ¬12

      # - name: Cache node modules
      #   id: cache # ç¼“å­˜id
      #   uses: actions/cache@v2
      #   env:
      #     cache-name: cache-node-modules # ç¼“å­˜åå­—
      #   with:
      #     path: node_modules # ç¼“å­˜è·¯å¾„
      #     key: ${{ runner.os }}-build-${{ env.cache-name }}-${{ hashFiles('package.json') }} # ç¼“å­˜æ ‡è¯†

      - name: Install pnpm
        run: npm i pnpm -g

      - name: Install Dependencies
        # if: steps.cache.outputs.cache-hit != 'true' # å¦‚æœæ²¡æœ‰ç¼“å­˜çš„è¯
        run: pnpm i # å®‰è£…ä¾èµ–

      - name: Build Packages
        run: pnpm run build #  æ‰“åŒ…æ–‡ä»¶

      - name: ğŸ‘·éƒ¨ç½²æ–‡æ¡£
        uses: JamesIves/github-pages-deploy-action@v4
        with:
          branch: gh-pages
          folder: ./.vitepress/dist
